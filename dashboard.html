<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style1.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karantina:wght@300;400;700&display=swap" rel="stylesheet">
    <title>REAL</title>
</head>
<body>
    <button id="login-btn">Login with Spotify</button>
    <p id="status"></p>
    
    <script>
        const clientId = '2f4438a4873044d195f984a43319e804';
        const redirectUri = 'https://ailujffshhh.github.io/Real/dashboard'; // Ensure this matches your Spotify Developer Dashboard settings
        const scopes = 'user-read-private user-read-email';
        
        // Initiate Authorization Request
        document.getElementById('login-btn').addEventListener('click', () => {
            const authUrl = `https://accounts.spotify.com/authorize?response_type=code&client_id=${encodeURIComponent(clientId)}&scope=${encodeURIComponent(scopes)}&redirect_uri=${encodeURIComponent(redirectUri)}`;
            window.location.href = authUrl;
        });

        // Handle Callback and Token Exchange (for educational purposes only)
        const queryParams = new URLSearchParams(window.location.search);
        const code = queryParams.get('code');
        
        if (code) {
            document.getElementById('status').textContent = `Authorization Code: ${code}`;
            exchangeCodeForToken(code);
        }

        // Exchange Authorization Code for Access Token
        function exchangeCodeForToken(code) {
            // Replace with your client secret
            const clientSecret = '79b9df7213d343f4a06ef3d2800b12b2'; // Never expose client_secret in production code

            fetch('https://accounts.spotify.com/api/token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Authorization': 'Basic ' + btoa(`${clientId}:${clientSecret}`)
                },
                body: new URLSearchParams({
                    grant_type: 'authorization_code',
                    code: code,
                    redirect_uri: redirectUri
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.access_token) {
                    document.getElementById('status').textContent = `Access Token: ${data.access_token}`;
                } else {
                    document.getElementById('status').textContent = 'Failed to retrieve access token.';
                }
            })
            .catch(error => {
                console.error('Error exchanging authorization code:', error);
                document.getElementById('status').textContent = 'Error exchanging authorization code.';
            });
        }
    </script>
</body>
</html>