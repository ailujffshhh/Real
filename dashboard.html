<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style1.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karantina:wght@300;400;700&display=swap" rel="stylesheet">
    <title>REAL</title>
</head>
<body>

    
        <h1>REAL</h1>
       
    <script>




        const express = require('express');
const querystring = require('querystring');
const axios = require('axios'); // To make HTTP requests
const app = express();
const port = 8888;

const clientId = '2f4438a4873044d195f984a43319e804'; // Replace with your Spotify client ID
const clientSecret = '79b9df7213d343f4a06ef3d2800b12b2'; // Replace with your Spotify client secret
const redirectUri = 'https://ailujffshhh.github.io/Real/dashboard';

app.get('/callback', async (req, res) => {
    const code = req.query.code;
    const state = req.query.state;

    if (code) {
        try {
            const tokenResponse = await axios.post('https://accounts.spotify.com/api/token', querystring.stringify({
                grant_type: 'authorization_code',
                code: code,
                redirect_uri: redirectUri
            }), {
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Authorization': 'Basic ' + Buffer.from(`${clientId}:${clientSecret}`).toString('base64')
                }
            });

            const accessToken = tokenResponse.data.access_token;
            res.send(`Access Token: ${accessToken}`);
        } catch (error) {
            res.send('Error exchanging authorization code for access token.');
            console.error('Error:', error);
        }
    } else {
        res.send('No authorization code found.');
    }
});

app.listen(port, () => {
    console.log(`Server running at http://localhost:${port}`);
});

const token = urlParams.get('access_token'); // Replace with your actual token

async function fetchWebApi(endpoint, method, body) {
    const res = await fetch(`https://api.spotify.com/${endpoint}`, {
        headers: {
            Authorization: `Bearer ${token}`,
            'Content-Type': 'application/json'
        },
        method,
        body: body ? JSON.stringify(body) : undefined
    });
    return await res.json();
}

async function getTopTracks() {
    // Endpoint reference: https://developer.spotify.com/documentation/web-api/reference/get-users-top-artists-and-tracks
    const response = await fetchWebApi(
        'v1/me/top/tracks?time_range=long_term&limit=5', 'GET'
    );
    return response.items;
}

function displayTopTracks() {
    getTopTracks().then(topTracks => {
        const tracksList = document.getElementById('tracks-list');
        topTracks.forEach(track => {
            const listItem = document.createElement('li');
            listItem.textContent = `${track.name} by ${track.artists.map(artist => artist.name).join(', ')}`;
            tracksList.appendChild(listItem);
        });
    }).catch(error => {
        console.error('Error fetching top tracks:', error);
    });
}

// Call the function to display top tracks on page load
displayTopTracks();
    </script>
</body>
</html>