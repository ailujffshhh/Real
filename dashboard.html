<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style1.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karantina:wght@300;400;700&display=swap" rel="stylesheet">
    <title>REAL</title>
</head>
<body>

    
        <h1>REAL</h1>
       
    <script>

const clientId = '2f4438a4873044d195f984a43319e804';
const redirectUri = 'https://ailujffshhh.github.io/Real/dashboard'; 
        const scopes = 'user-read-private user-read-email';
const authEndpoint = 'https://accounts.spotify.com/authorize';
        const tokenEndpoint = 'https://accounts.spotify.com/api/token';
function fetchAccessToken(code) {
            return fetch(tokenEndpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Authorization': 'Basic ' + btoa(`${clientId}:`)
                },
                body: new URLSearchParams({
                    grant_type: 'authorization_code',
                    code: code,
                    redirect_uri: redirectUri
                })
            }).then(response => response.json());
        }

        function fetchTopTracks(accessToken) {
            return fetch('https://api.spotify.com/v1/me/top/tracks?time_range=long_term&limit=5', {
                headers: {
                    'Authorization': `Bearer ${accessToken}`
                }
            }).then(response => response.json());
        }

        function displayTopTracks(topTracks) {
            const tracksList = document.getElementById('tracks-list');
            topTracks.items.forEach(track => {
                const listItem = document.createElement('li');
                listItem.textContent = `${track.name} by ${track.artists.map(artist => artist.name).join(', ')}`;
                tracksList.appendChild(listItem);
            });
        }

        function handleAuth() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');

            if (code) {
                fetchAccessToken(code)
                    .then(data => fetchTopTracks(data.access_token))
                    .then(topTracks => {
                        document.getElementById('content').innerHTML = `
                            <h2>Top Tracks</h2>
                            <ul id="tracks-list"></ul>
                        `;
                        displayTopTracks(topTracks);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        document.getElementById('content').textContent = 'Error fetching top tracks.';
                    });
            } else {
                document.getElementById('content').innerHTML = `
                    <button id="login-btn">Login with Spotify</button>
                `;

                document.getElementById('login-btn').addEventListener('click', redirectToSpotifyLogin);
            }
        }

        handleAuth();

    </script>
</body>
</html>